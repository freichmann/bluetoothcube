#:kivy 1.0.9

<CubeButton>:
    button: button
    size_hint: 1, None
    height: button.height + dp(30)
    Button:
        id: button
        size_hint: 0.85, None
        font_size: '50sp'
        height: '80sp'


<CubeStateDisplay>:
    orientation: 'vertical'
    corner_pos: corner_pos
    corner_ori: corner_ori
    edge_pos: edge_pos
    edge_ori: edge_ori
    size_hint: 1, None
    height: 4*dp(22)
    Label:
        size_hint: 1, None
        id: corner_pos
        font_size: '20dp'
        height: '22dp'
    Label:
        size_hint: 1, None
        id: corner_ori
        font_size: '20dp'
        height: '22dp'
    Label:
        size_hint: 1, None
        id: edge_pos
        font_size: '20dp'
        height: '22dp'
    Label:
        size_hint: 1, None
        id: edge_ori
        font_size: '20dp'
        height: '22dp'


<BluetoothCubeRoot>:
    cubelist: cubelist
    connecting_label: connecting_label
    connecting_progressbar: connecting_progressbar
    connecting_cancelbutton: connecting_cancelbutton
    disconnectbutton: disconnectbutton

    Screen:
        name: "cube-selection"
        BoxLayout:
            orientation: 'vertical'
            Label:
                size_hint: 1, None
                text: "Select a cube:"
                font_size: '40sp'
                height: '42sp'
            BoxLayout:
                orientation: 'vertical'
                id: cubelist
                size_hint: 1, 1

                Label:
                    size_hint: 1, 1
                    text: "Scanning for cubes..."
                    font_size: '20sp'
                    height: '20sp'

            HideableLabel:
                size_hint: 1, None
                text: "Make sure bluetooth is enabled and\nthat your cube is charged and activated."
                halign: 'center'
                font_size: '20sp'
                height: self.texture_size[1] + dp(20)
            Button:
                text: "Continue without a cube"
                size_hint: 1, None
                font_size: '20sp'
                height: self.texture_size[1] + dp(20)
                on_press: app.continue_without_cube()


    Screen:
        name: "connecting"
        id: connecting

        AnchorLayout:
            BoxLayout:
                size_hint: 0.8, None
                padding: '20sp'
                orientation: 'vertical'
                Label:
                    id: connecting_label
                    size_hint: 1, None
                    text: ""
                    font_size: '20sp'
                    size: self.texture_size
                ProgressBar:
                    size_hint: 1, None
                    id: connecting_progressbar
                    max: 100
                    height: '50sp'
                AnchorLayout:
                    size_hint: 1, None
                    connecting_cancelbutton: connecting_cancelbutton
                    height: connecting_cancelbutton.height
                    anchor_y: 'bottom'
                    DisconnectButton:
                        id: connecting_cancelbutton
                        size_hint: None, None
                        text: "Cancel"
                        font_size: '20sp'
                        size: self.texture_size[0] + dp(30), self.texture_size[1] + dp(30),


    Screen:
        name: "timer"
        BoxLayout:
            orientation: 'vertical'
            bcolor: 0, 0, 1, 0

            canvas.before:
                Color:
                    rgba: self.bcolor
                Rectangle:
                    pos: self.x - self.parent.x, self.y - self.parent.y
                    size: self.size

            BoxLayout:
                orientation: 'horizontal'
                size_hint: 1, None
                height: '40dp'
                DisconnectButton:
                    id: disconnectbutton
                    size_hint: 0.33, 1
                    pos_hint: {'right': self.parent.right}
                    text: "Disconnect cube"

            CubeStateDisplay:

            TimeDisplay:
                time_text_ratio: 0.38
                size_hint: 1, 1
                font_size: min(self.width * self.time_text_ratio, self.height * 0.7)
                text: "0.0"

            PrimeButton:
                size_hint: 1, None
                id: primebutton
                text: "Prime" if not app.timer.primed else "Disarm"
                font_size: max(dp(40), mm(8))
                height: self.font_size + dp(15)

            TimerButton:
                size_hint: 1, None
                id: timerbutton
                text: "Start" if not app.timer.running else "Stop"
                font_size: max(dp(40), mm(8))
                height: self.font_size + dp(15)
